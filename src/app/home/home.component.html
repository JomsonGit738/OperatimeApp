<div
  *ngIf="combinedData | async as movieData; else loader"
  class="ms-0 me-0 allmovies"
>
  <div class="content-container">
    <div
      [ngStyle]="{
        'background-image':
          'linear-gradient(to bottom, rgba(0,0,0,0), #151515), url(' +
          this.image +
          ')'
      }"
      class="fp1"
    >
      <div class="tMovies-backdrop">
        <div class="movieCard">
          <h2 style="color: white; font-weight: bold">{{ title }}</h2>
          <p class="featured-desc">{{ desc }}</p>
          <div
            class="direct"
            style="display: flex; justify-content: space-between"
          >
            <button
              (click)="routeForBooking(mId, title)"
              class="featured-button"
            >
              Book tickets <i class="fa-solid fa-ticket"></i>
            </button>
            <i
              (click)="routeWithId(mId)"
              class="fa-solid fa-circle-info fa-2xl"
              style="color: #ffffff; align-self: center; cursor: pointer"
            ></i>
          </div>
        </div>
      </div>
      <div class="tMovies-poster">
        <h2>In Theatre now</h2>
        <div class="posterClass">
          <div
            class="poster"
            *ngFor="let movie of movieData?.nowPlayingsMovies?.slice(0, 4)"
            [class.poster--active]="movie.id === activePosterId"
          >
            <img
              (click)="onChangeMovieCard(movie)"
              [src]="imageBASEurl + movie.poster_path"
              alt="{{ movie.title }}"
            />
          </div>
        </div>
      </div>
    </div>
    <div class="mContainer">
      <div class="mContainerHead">
        <h2>New Releases</h2>
      </div>
      <div class="mContainerList">
        <div
          class="card"
          *ngFor="let movie of movieData.homeMovies.slice(0, 6)"
        >
          <img
            (click)="routeWithId(movie.id)"
            [src]="imageBASEurl + movie.poster_path"
            alt=""
          />
          <div class="card-content">
            <h4>{{ movie.title }}</h4>
            <p>
              <i class="fa-solid fa-star" style="color: #e00606"></i>
              {{ movie.vote_average }} /10
            </p>
            <div
              class="genre"
              style="background-color: #020202"
              *ngFor="let m of movie.genre_ids"
            >
              {{ getGenres(movieData.genersList, movie.genre_ids) }}
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="mContainer">
      <div class="mContainerHead">
        <h2>Trending Now</h2>
      </div>
      <div class="mContainerList">
        <div
          class="card"
          *ngFor="let movie of movieData.homeMovies.slice(6, 12)"
        >
          <img
            (click)="routeWithId(movie.id)"
            [src]="imageBASEurl + movie.poster_path"
            alt=""
          />
          <div class="card-content">
            <h4>{{ movie.title }}</h4>
            <p>
              <i class="fa-solid fa-star" style="color: #e00606"></i>
              {{ movie.vote_average }} /10
            </p>
            <div
              class="genre"
              style="background-color: #020202"
              *ngFor="let m of movie.genre_ids"
            >
              {{ getGenres(movieData.genersList, movie.genre_ids) }}
            </div>
          </div>
        </div>
      </div>
    </div>
    <div
      *ngIf="movieData?.homeMovies?.[19] as featuredMovie"
      class="featured-content fp2"
      [ngStyle]="{
        'background-image':
          'linear-gradient(to bottom, rgba(0,0,0,0), #151515), url(' +
          imageBASEurl +
          (featuredMovie.backdrop_path ||
            featuredMovie.poster_path ||
            '') +
          ')'
      }"
    >
      <h1 style="color: white; font-weight: bold">
        {{ featuredMovie.title }}
      </h1>
      <p class="featured-desc" style="max-width: 300px">
        {{ featuredMovie.overview || 'Description unavailable.' }}
      </p>
    </div>
    <div class="mContainer">
      <div class="mContainerHead">
        <h2>Latest Movies</h2>
      </div>
      <div class="mContainerList">
        <div
          class="card"
          *ngFor="let movie of movieData.homeMovies.slice(12, 18)"
        >
          <img
            (click)="routeWithId(movie.id)"
            [src]="imageBASEurl + movie.poster_path"
            alt=""
          />
          <div class="card-content">
            <h4>{{ movie.title }}</h4>
            <p>
              <i class="fa-solid fa-star" style="color: #e00606"></i>
              {{ movie.vote_average }} /10
            </p>
            <div
              class="genre"
              style="background-color: #020202"
              *ngFor="let m of movie.genre_ids; let j = index"
            >
              {{ getGenres(movieData.genersList, movie.genre_ids) }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #loader>
  <div class="d-flex align-items-center justify-content-center w-100 vh-100">
    <div class="d-flex flex-column align-items-center justify-content-center text-center gap-3">
      <app-loader></app-loader>
      <p class="text-uppercase fw-semibold text-white mb-0">Loading the latest movies...</p>
    </div>
  </div>
</ng-template>

